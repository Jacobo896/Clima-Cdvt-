<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clima y Radar - Jacobo</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }

        header {
            background-color: #2c3e50;
            color: white;
            padding: 10px 20px;
            text-align: center;
        }

        header h1 {
            margin: 0;
        }

        nav input {
            padding: 10px;
            width: 80%;
            max-width: 400px;
            margin-top: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        main {
            padding: 20px;
        }

        section {
            margin-bottom: 30px;
        }

        #weather-info, #historical-data {
            background-color: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        #radar-map {
            width: 100%;
            height: 400px;
        }

        footer {
            text-align: center;
            padding: 10px;
            background-color: #2c3e50;
            color: white;
        }
    </style>
</head>
<body>
    <header>
        <h1>Clima y Radar</h1>
        <nav>
            <input type="text" id="search-bar" placeholder="Buscar ciudad o país..." oninput="searchWeather()">
        </nav>
    </header>

    <main>
        <section id="weather-info">
            <h2>Información del Clima</h2>
            <div id="current-weather">
                <p><strong>Temperatura:</strong> <span id="temp"></span> °C</p>
                <p><strong>Condición:</strong> <span id="condition"></span></p>
                <p><strong>Humedad:</strong> <span id="humidity"></span>%</p>
                <p><strong>Viento:</strong> <span id="wind-speed"></span> km/h</p>
            </div>

            <h3>Pronóstico Extendido</h3>
            <div id="forecast">
                <!-- Pronóstico extendido aquí -->
            </div>
        </section>

        <section id="radar">
            <h2>Radar Meteorológico</h2>
            <div id="radar-map" style="height: 400px;"></div>
        </section>

        <section id="historical-data">
            <h2>Datos Históricos</h2>
            <button onclick="fetchHistoricalData()">Ver datos históricos</button>
            <div id="historical-data-info"></div>
        </section>
    </main>

    <footer>
        <p>Desarrollado por Jacobo</p>
    </footer>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        // Función para obtener el clima de la ciudad introducida
        function searchWeather() {
            const city = document.getElementById('search-bar').value;
            if (city.length >= 3) {
                fetchWeatherData(city);
            }
        }

        // Función que consulta la API de OpenWeatherMap
        function fetchWeatherData(city) {
            const apiKey = 'YOUR_API_KEY';  // Reemplaza con tu API Key de OpenWeatherMap
            const apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=es`;

            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    displayWeather(data);
                })
                .catch(error => {
                    console.error('Error al obtener los datos del clima:', error);
                });
        }

        // Muestra la información del clima en la página
        function displayWeather(data) {
            const temp = data.main.temp;
            const condition = data.weather[0].description;
            const humidity = data.main.humidity;
            const windSpeed = data.wind.speed;

            document.getElementById('temp').innerText = temp;
            document.getElementById('condition').innerText = condition;
            document.getElementById('humidity').innerText = humidity;
            document.getElementById('wind-speed').innerText = windSpeed;

            // Aquí puedes agregar el pronóstico extendido (7 días o más)
            displayForecast(data.coord.lat, data.coord.lon);
        }

        // Función para cargar el mapa de radar
        function loadRadarMap() {
            const radarMap = L.map('radar-map').setView([20.0, 0.0], 2);  // Vista predeterminada

            L.tileLayer('https://{s}.tile.openweathermap.org/map/rain/2/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://openweathermap.org">OpenWeatherMap</a>'
            }).addTo(radarMap);
        }

        // Función para mostrar el pronóstico extendido
        function displayForecast(lat, lon) {
            const apiKey = 'YOUR_API_KEY';
            const forecastUrl = `https://api.openweathermap.org/data/2.5/onecall?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric&lang=es`;

            fetch(forecastUrl)
                .then(response => response.json())
                .then(data => {
                    let forecastHTML = '<ul>';
                    data.daily.forEach(day => {
                        const date = new Date(day.dt * 1000);
                        forecastHTML += `
                            <li>
                                <strong>${date.toDateString()}</strong>: 
                                ${day.temp.day}°C - ${day.weather[0].description}
                            </li>
                        `;
                    });
                    forecastHTML += '</ul>';
                    document.getElementById('forecast').innerHTML = forecastHTML;
                })
                .catch(error => {
                    console.error('Error al obtener el pronóstico:', error);
                });
        }

        // Función para obtener datos históricos del clima
        function fetchHistoricalData() {
            const city = document.getElementById('search-bar').value;
            const apiKey = 'YOUR_API_KEY';  // Reemplaza con tu API Key de OpenWeatherMap
            const historicalUrl = `https://api.openweathermap.org/data/2.5/onecall/timemachine?lat=35.6895&lon=139.6917&dt=1633024800&appid=${apiKey}&units=metric`;

            fetch(historicalUrl)
                .then(response => response.json())
                .then(data => {
                    displayHistoricalData(data);
                })
                .catch(error => {
                    console.error('Error al obtener los datos históricos:', error);
                });
        }

        // Muestra los datos históricos en la página
        function displayHistoricalData(data) {
            const historicalDataDiv = document.getElementById('historical-data-info');
            historicalDataDiv.innerHTML = `
                <p><strong>Temperatura:</strong> ${data.current.temp} °C</p>
                <p><strong>Condición:</strong> ${data.current.weather[0].description}</p>
                <p><strong>Humedad:</strong> ${data.current.humidity}%</p>
                <p><strong>Viento:</strong> ${data.current.wind_speed} km/h</p>
            `;
        }

        // Cargar el mapa de radar al iniciar
        window.onload = function() {
            loadRadarMap();
        };
    </script>
</body>
</html>
